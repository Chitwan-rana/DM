{% extends "base.html" %} {% load static %}
{% block main %}

<div class="container mt-4">
     <h2 class="text-primary text-center mb-4">Document Classifier</h2>
 
     <!-- Create Label Section -->
     <div class="card shadow-sm p-4 mb-4">
         <h3 class="text-secondary">Create a Label</h3>
         <form method="post">
             {% csrf_token %}
             <div class="mb-3">
                 {{ label_form.as_p }}
             </div>
             <button type="submit" name="create_label" class="btn btn-success">Create Label</button>
         </form>
     </div>
 
     <form method="POST" enctype="multipart/form-data">
        {% csrf_token %}
        
        <label>Select Label:</label>
        <select name="label">
            {% for label in labels %}
            <option value="{{ label.id }}">{{ label.name }}</option>
            {% endfor %}
        </select>
    
        <label>Upload Images:</label>
        <input type="file" name="images" multiple required>
    
        <button type="submit" name="upload_images">Upload</button>
    </form>
    
 
     {% comment %} <!-- Labels Display -->
     <div class="card shadow-sm p-4 mb-4">
         <h3 class="text-secondary">Available Labels</h3>
         <ul class="list-group">
             {% for label in labels %}
             <li class="list-group-item">{{ label.name }}</li>
             {% endfor %}
         </ul>
     </div> {% endcomment %}
 
     <!-- Uploaded Images Display -->
     <div class="card shadow-sm p-4 mb-4">
         <h3 class="text-secondary">Uploaded Images</h3>
         <div class="row">
             {% for image in images %}
             <div class="col-md-3 mb-3">
                 <div class="card">
                     <img src="{{ image.image.url }}" class="card-img-top" alt="{{ image.image.name }}">
                     <div class="card-body text-center">
                         <p class="card-text"><strong>{{ image.label.name }}</strong></p>
                     </div>
                 </div>
             </div>
                    {% if image_form.errors %}
            <div class="alert alert-danger">
                <ul>
                    {% for error in image_form.non_field_errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                </ul>
            </div>
        {% endif %}

             {% endfor %}
         </div>
     </div>
 
     <!-- Train Model Section -->
     <div class="text-center mb-4 ">
         <form method="post" action="{% url 'train_model' %}">
             {% csrf_token %}
             <button type="submit" class="btn btn-warning">Train Model</button>
         </form>
         <div class="text-center mt-4">
         <form method="post" action="{% url 'reset_data' %}" onsubmit="return confirm('Are you sure you want to delete all data? This action cannot be undone!');">
            {% csrf_token %}
            <button type="submit" class="btn btn-danger">Reset Data</button>
        </form>
    </div>
            {% if messages %}
        {% for message in messages %}
            <div class="alert alert-success">
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}

     </div>
 
     <!-- Predict Label Section -->
     <div class="card shadow-sm p-4">
         <h3 class="text-secondary">Predict a Label</h3>
         <form method="post" enctype="multipart/form-data" action="{% url 'predict_label' %}">
             {% csrf_token %}
             <div class="mb-3">
                 <input type="file" name="image" class="form-control" required>
             </div>
             <button type="submit" class="btn btn-danger">Predict</button>
         </form>
     </div>
 </div>
 
 <!-- Bootstrap CDN (if not already included in base.html) -->
 <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
 
 {% endblock main %}

