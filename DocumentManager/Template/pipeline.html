{% extends "base.html" %}
{% load static %}

{% block main %}

<style>
.dropzone h5 {
    color: white;
    position: absolute;
    top: 50%;
    left: 50%; 
    transform: translate(-50%, -50%);
    margin: 0;
    font-size: 1rem;
    transition: left 0.3s ease, transform 0.3s ease; 
}

.dropzone {
    border: 2px dashed #ffffff;
    background-color: #2a2c39;
    min-height: 100px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    transition: padding-left 0.3s ease; 
    padding-left: 0; 
}

.dropzone.has-cards {
    padding-left: 100px; 
}

.dropzone.has-cards h5 {
    left: 20px; 
    transform: translateY(-50%) translateX(0); 
}

.dropped-cards-container {
    display: flex;
    gap: 10px;
    justify-content: center;
    align-items: center;
    flex-wrap: wrap;
    transition: all 0.3s ease; 
}

.dropped-card {
    width: auto;
    padding: 10px;
    background-color: #fff;
    color: #000;
    border-radius: 5px;
    text-align: center;
    font-size: 1rem;
    border: 1px solid #ddd;
    opacity: 0;
    transform: scale(0.8);
    transition: opacity 0.3s ease, transform 0.3s ease; 
}

.dropped-card.visible {
    opacity: 1;
    transform: scale(1); 
}


.dustbin {
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    cursor: pointer;
    width: 40px;
    height: 40px;
}

.dustbin svg {
    fill: white;
    width: 100%;
    height: 100%;
}

  
.proceed-button {
    display: block;
    padding: 12px;
    text-align: center;
    background-color: #ef6603; 
    color: white;
    border: none;
    border-radius: 15px;
    font-size: 1.2rem;
    margin-top: 20px;
    margin-left:45%;
    cursor: pointer;
    transition: background-color 0.3s ease;
}
.col-md-2 {
  flex: 0 0 auto;
  width: 20%;

.proceed-button:hover {
    background-color: #ff8c00;
}

.card-hover {
  position: relative;
  overflow: hidden;
  text-align: center;
  border: 1px solid #ddd;
  border-radius: 8px;
  transition: transform 0.3s ease;
}

.card-hover:hover {
  transform: scale(1.05);
}

.card-image {
  position: relative;
  padding: 15px;
}

.card-image img {
  width: 100%;
  height: auto;
  border-radius: 8px 8px 0 0;
}

.card-title {
  margin-top: 10px;
  font-size: 1rem;
  font-weight: bold;
}

.card-hover-content {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.7);
  color: #fff;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  opacity: 0;
  transition: opacity 0.3s ease;
  border-radius: 8px;
}

.card-hover:hover .card-hover-content {
  opacity: 1;
}

.card-hover-content .card-text {
  margin: 0;
  font-size: 0.9rem;
  padding: 0 10px;
}

</style>

</head>
<main class="main">

 
  <section id="about" class="about section">


    <div class="container section-title" data-aos="fade-up">
      <h2>Draggable</h2>
      <p>Drag items </p>
    </div>


    <div class="container mb-4">
      <label for="pipelineName" style="color: white;">Pipeline Name:</label>
      <input type="text" id="pipelineName" placeholder="Enter pipeline name" style="width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #ef6603;  ">
    </div>


    <div class="container">
      <div class="container my-5">
        <div class="row justify-content-center">
          <div class="col-md-2 col-sm-4 col-6 mb-4">
            <div class="card card-hover" draggable="true" ondragstart="drag(event)" id="card1">
              <div class="card-image">
                <img src="{% static 'assets/img/Preprocessing.jpg' %}" class="card-img-top" alt="Card Image">
                <h5 class="card-title">Pre Processing</h5>
              </div>
              <div class="card-hover-content">
                <p class="card-text">Preprocessing data involves cleaning, transforming, and organizing raw data to prepare it for analysis or modeling.</p>
              </div>
            </div>
          </div>
          <div class="col-md-2 col-sm-4 col-6 mb-4">
            <div class="card card-hover" draggable="true" ondragstart="drag(event)" id="card2">
              <div class="card-image">
                <img src="{% static 'assets/img/classification.jpg' %}" class="card-img-top" alt="Card Image">
                <h5 class="card-title">Classification</h5>
              </div>
              <div class="card-hover-content">
                <p class="card-text">Classification data refers to labeled data used in machine learning to categorize items into predefined classes or groups based on their features.</p>
              </div>
            </div>
          </div>
          <div class="col-md-2 col-sm-4 col-6 mb-4">
            <div class="card card-hover" draggable="true" ondragstart="drag(event)" id="card3">
              <div class="card-image">
                <img src="{% static 'assets/img/Demo.jpg' %}" class="card-img-top" alt="Card Image">
                <h5 class="card-title">Extraction</h5>
              </div>
              <div class="card-hover-content">
                <p class="card-text">Data extraction is the process of retrieving relevant information from various sources for analysis or processing.</p>
              </div>
            </div>
          </div>
          <div class="col-md-2 col-sm-4 col-6 mb-4">
            <div class="card card-hover" draggable="true" ondragstart="drag(event)" id="card4">
              <div class="card-image">
                <img src="{% static 'assets/img/Validation.jpg' %}" class="card-img-top" alt="Card Image">
                <h5 class="card-title">Validation</h5>
              </div>
              <div class="card-hover-content">
                <p class="card-text">Validation data is a subset of data used to assess the performance of a model during training, ensuring it generalizes well to unseen data.</p>
              </div>
            </div>
          </div>
          <div class="col-md-2 col-sm-4 col-6 mb-4">
            <div class="card card-hover" draggable="true" ondragstart="drag(event)" id="card5">
              <div class="card-image">
                <img src="{% static 'assets/img/Posting.jpg' %}" class="card-img-top" alt="Card Image" style="height:170px;">
                <h5 class="card-title">Posting</h5>
              </div>
              <div class="card-hover-content">
                <p class="card-text">Posting data typically refers to sending information to a server using the HTTP POST method, often to create or update resources</p>
              </div>
            </div>
          </div>
        </div>
      </div>


    <div class="container-fluid py-3 text-white dropzone" ondrop="drop(event)" ondragover="allowDrop(event)">
      <h5>Drag cards here: </h5>
      <div class="dropped-cards-container"></div>

      <div class="dustbin" ondrop="deleteAllCards(event)" ondragover="allowDrop(event)">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M3 6h18M9 6v12M15 6v12M3 6h18"></path>
          <path d="M19 7l-1.5 12h-13L5 7"></path>
          <path d="M10 18h4"></path>
        </svg>
      </div>
    </div>


    <button class="proceed-button" onclick="createPipeline()">Create Pipeline</button>


        <!-- Popup structure -->
        <div id="pipelinePopup" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #fff; padding: 20px; border-radius: 10px; z-index: 1000; box-shadow: 0px 0px 10px rgba(0,0,0,0.5);">
          <h3>Pipeline Details</h3>
          <p id="popupPipelineName" style="font-weight: bold;"></p>
          <ul id="popupFeaturesList"></ul>
          <button onclick="closePopup()" style="margin-top: 10px; padding: 10px; background-color: #ef6603; color: white; border: none; border-radius: 5px;">Close</button>
        </div>

    <script>
      let addedCardIds = [];

      // Allow dragging over a drop zone
      function allowDrop(event) {
        event.preventDefault();
      }
      
      // Start dragging a card
      function drag(event) {
        event.dataTransfer.setData("text", event.target.id);
      }
      
      // Drop a card into the drop zone
      function drop(event) {
        event.preventDefault();
      
        const cardId = event.dataTransfer.getData("text");
        const card = document.getElementById(cardId);
      
        // Check if the card is already added
        if (addedCardIds.includes(cardId)) {
          alert("This card has already been added!");
          return;
        }
      
        addedCardIds.push(cardId);
      
        // Create a dropped card element
        const cardTitle = card.querySelector('.card-title').textContent;
      
        const droppedCard = document.createElement('div');
        droppedCard.className = 'dropped-card';
        droppedCard.textContent = cardTitle;
        droppedCard.setAttribute("id", cardId);
        droppedCard.setAttribute("draggable", "true");
        droppedCard.ondragstart = function(event) { drag(event) };
      
        const container = document.querySelector('.dropped-cards-container');
        container.appendChild(droppedCard);
      
        setTimeout(() => {
          droppedCard.classList.add('visible');
        }, 10);
      
        // Update drop zone appearance
        const dropzone = document.querySelector('.dropzone');
        dropzone.classList.add('has-cards');
      }
      
      // Delete all cards from the drop zone
      function deleteAllCards(event) {
        event.preventDefault();
        event.stopPropagation();
      
        const container = document.querySelector('.dropped-cards-container');
        container.innerHTML = '';
        addedCardIds = [];
      
        const dropzone = document.querySelector('.dropzone');
        dropzone.classList.remove('has-cards');
      }
      
      // Create a pipeline popup
      function createPipeline() {
        const pipelineName = document.getElementById("pipelineName").value.trim();
        const container = document.querySelector('.dropped-cards-container');
        const features = container.querySelectorAll('.dropped-card');
      
        if (!pipelineName) {
          alert("Please enter a pipeline name!");
          return;
        }
      
        if (features.length === 0) {
          alert("Please drag at least one feature into the pipeline!");
          return;
        }
      
        const featureList = Array.from(features).map(feature => feature.textContent);
      
        // Create and display a popup with pipeline details
        const popupContent = `
          <div style="padding: 20px; background-color: #fff; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.5); width: 300px; margin: 50px auto;">
            <h3 style="margin-bottom: 20px;">Pipeline Created</h3>
            <p><strong>Pipeline Name:</strong> ${pipelineName}</p>
            <p><strong>Features:</strong></p>
            <ul style="list-style-type: none; padding: 0;">
              ${featureList.map(feature => `<li>${feature}</li>`).join('')}
            </ul>
            <button onclick="closePopup()" style="margin-top: 20px; padding: 10px 20px; background-color: #ef6603; color: white; border: none; border-radius: 5px; cursor: pointer;">Close</button>
          </div>
        `;
      
        const popup = document.createElement('div');
        popup.id = "popup";
        popup.style.position = "fixed";
        popup.style.top = "0";
        popup.style.left = "0";
        popup.style.width = "100vw";
        popup.style.height = "100vh";
        popup.style.backgroundColor = "rgba(0, 0, 0, 0.7)";
        popup.style.display = "flex";
        popup.style.justifyContent = "center";
        popup.style.alignItems = "center";
        popup.innerHTML = popupContent;
      
        document.body.appendChild(popup);
      }
      
      // Close the popup window
      function closePopup() {
        const popup = document.getElementById("popup");
        if (popup) {
          popup.remove();
        }
      }
      
      const dustbin = document.querySelector('.dustbin');
      dustbin.addEventListener('drop', deleteAllCards);
      dustbin.addEventListener('dragover', allowDrop);
      
   </script>
   
  </section>

{% endblock main %}
   